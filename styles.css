/* styles.css */

:root {
    --bg-color: #1b1b1b;
    --primary: #55ff55;
    --danger: #ff5555;
    --warn: #ffcc00;
    --orange: #ff8800;
    --phase: #bd00ff;
    --text-shadow: 2px 2px 0px #000000;
}

/* === ГЛОБАЛЬНЫЕ НАСТРОЙКИ === */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    touch-action: none; /* Главный запрет на жесты браузера */
}

html, body {
    width: 100%;
    height: 100%;
    overflow: hidden; /* Запрет скролла */
    background-color: #000;
    font-family: 'Press Start 2P', cursive;
    color: white;
    /* Блокировка "резинового" эффекта на iOS */
    overscroll-behavior: none;
    position: fixed; 
}

#app-wrapper {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #111;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* === ИГРОВОЙ КОНТЕЙНЕР (360x640) === */
#game-container {
    position: relative;
    width: 360px;
    height: 640px;
    background: #222;
    overflow: hidden;
    box-shadow: 0 0 50px rgba(0,0,0,0.5);
}

/* === ЭКРАНЫ === */
.screen {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: none;
    flex-direction: column;
    align-items: center; /* Центрирование по горизонтали */
    justify-content: center; /* Центрирование по вертикали */
    background: rgba(0, 0, 0, 0.9);
    z-index: 100;
}

.screen.active { display: flex; }

/* Меню контент */
.menu-content, .result-content {
    display: flex;
    flex-direction: column;
    align-items: center; /* Исправление смещения кнопок */
    width: 100%;
}

.game-title {
    font-size: 32px;
    color: var(--primary);
    text-align: center;
    line-height: 1.4;
    margin-bottom: 40px;
    text-shadow: 4px 4px 0px #000;
}

.pixel-btn {
    font-family: inherit;
    font-size: 16px;
    padding: 20px 30px;
    background: #fff;
    color: #000;
    border: 4px solid #000;
    box-shadow: 6px 6px 0px #555;
    cursor: pointer;
    margin-top: 30px;
    transition: transform 0.1s;
    text-align: center;
}

.pixel-btn:active {
    transform: translate(4px, 4px);
    box-shadow: 2px 2px 0px #555;
}

/* === ИГРОВОЙ МИР === */
#game-bg {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
    opacity: 0.5;
}

#world-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 10;
}

.sprite {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
}

/* === СПРАЙТЫ АНИМАЦИИ === 
   Мы не используем <img> для спрайтов, а используем background-image.
   JS будет менять background-position.
*/
.anim-sprite {
    position: absolute;
    top: 0;
    left: 0;
    width: 360px; /* Ширина ОДНОГО кадра */
    height: 640px;
    background-repeat: no-repeat;
    opacity: 0; /* Скрыт по умолчанию */
    transition: opacity 0.2s;
    pointer-events: none;
    mix-blend-mode: normal; /* Можно поставить screen для свечения */
}

/* ИКОНКИ (Подсказки) */
.icon-indicator {
    position: absolute;
    width: 64px;
    height: 64px;
    object-fit: contain;
    opacity: 0.9;
    filter: drop-shadow(0 0 5px rgba(0,0,0,0.8));
    pointer-events: none;
    transition: opacity 0.2s;
}

.hidden { display: none !important; opacity: 0 !important; }

/* Координаты иконок (Исправленные) */
#icon-head {
    top: 100px;
    right: 40px; /* Сдвинули правее как просил */
    animation: spin-pulse 2s linear infinite;
}

#icon-body {
    top: 370px;
    right: 40px; 
    transform-origin: center;
    animation: stretch-vertical 1s ease-in-out infinite;
}

#icon-tap-1 {
    top: 570px;
    left: 58px; /* Центр левой половины (90 - 32) */
    width: 64px; height: 64px;
    animation: tap-pulse 0.4s ease infinite alternate;
}

#icon-tap-2 {
    top: 570px;
    left: 238px; /* Центр правой половины (270 - 32) */
    width: 64px; height: 64px;
    animation: tap-pulse 0.4s ease infinite alternate-reverse;
}

/* === UI ИНТЕРФЕЙС === */
#ui-layer {
    position: absolute;
    width: 100%;
    height: 100%;
    z-index: 20;
    pointer-events: none;
}

.top-hud {
    position: absolute;
    top: 10px; left: 10px; right: 10px;
    display: flex; align-items: center; gap: 15px;
}

#timer-digits {
    font-size: 20px;
    color: white;
    text-shadow: 2px 2px 0 #000;
    width: 60px;
}
.timer-normal { color: white; }
.timer-warn { color: var(--warn) !important; }
.timer-orange { color: var(--orange) !important; }
.timer-crit { color: var(--danger) !important; animation: blink 0.5s infinite; }

.progress-bar-container {
    flex-grow: 1; height: 24px;
    background: #333; border: 2px solid #fff;
    position: relative; box-shadow: 2px 2px 0 #000;
}

#progress-fill {
    height: 100%; width: 0%;
    background: var(--primary);
    transition: width 0.2s linear;
}

#score-text {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%;
    display: flex; align-items: center; justify-content: center;
    font-size: 10px; color: white; text-shadow: 1px 1px 0 #000; z-index: 2;
}

#phase-timer-container {
    position: absolute; top: 45px; left: 10px; right: 10px;
    height: 8px; background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.3);
}

#phase-timer-fill {
    height: 100%; width: 100%;
    background: var(--phase); box-shadow: 0 0 5px var(--phase);
}

/* === ЗОНЫ КАСАНИЯ (HITBOXES) === */
#input-layer {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 30;
}

.touch-zone {
    position: absolute;
    /* border: 1px solid rgba(255, 0, 0, 0.3);  Включи для отладки */
}

/* 1. ГОЛОВА */
#zone-head {
    top: 0; left: 0; width: 100%; height: 240px;
}

/* 2. ТЕЛО (Узкая полоска) */
#zone-body {
    top: 240px;
    height: 260px;
    width: 100px; /* Шире чем 25px, иначе не попадешь, поверь */
    left: 50%;
    transform: translateX(-50%); /* Строго по центру */
}

/* 3. ТАПЫ (Две зоны) */
#zone-tap-left {
    top: 500px; left: 0; width: 50%; height: 140px;
}
#zone-tap-right {
    top: 500px; left: 50%; width: 50%; height: 140px;
}

/* Анимации UI */
@keyframes spin-pulse { 0% { transform: scale(1) rotate(0deg); } 50% { transform: scale(1.15) rotate(180deg); } 100% { transform: scale(1) rotate(360deg); } }
@keyframes stretch-vertical { 0% { transform: scaleY(1); } 50% { transform: scaleY(1.25); } 100% { transform: scaleY(1); } }
@keyframes tap-pulse { 0% { transform: scale(1); } 100% { transform: scale(1.15); } }
@keyframes blink { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

/* Всплывающий текст */
.floating-text {
    position: absolute; font-size: 14px; font-weight: bold;
    pointer-events: none; z-index: 40;
    animation: floatUp 0.8s ease-out forwards; text-shadow: 1px 1px 0 #000;
}
.text-score { color: var(--primary); }
.text-penalty { color: var(--danger); }
@keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-40px); opacity: 0; } }